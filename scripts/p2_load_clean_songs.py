import os, json
import pandas as pd
import re
import subprocess
master_path='/home/ator97/Documents/git/npl_music/'
path_to_json = master_path+'artist'

words =['tradiciуn','trai','traicioneeeeeeeros','train','trains','trash','traurig','travas','trave','travel','traveler','travelling','traé','traña','trelew','trepo','trewa','tried','tristalisis','triti','triunvirato','trn','troia','troje','trolas','trole','troley','trolley','tron','trop','trouble','trouxe','truchó','true','truth','try','trying','tua','tube','tuco','tucuta','tudo','tugurios','tuka','tul','tum','tuo','turma','turmas','turn','turnan','turned','turno','turok','tusun','tutti','tutto','tutía','tuu','tuuu','tuuuu','tuv','twenty','twice','twist','twister','twitter','two','tzintzuntzan','tzu','tá','tábara','tão','tétere','têm','têmpora','tête','tï','tô','ua','uaaaayaahhh','uan','uaua','uauaaaa','uay','uccidi','ue','uh','uhh','uhhh','uhhhh','uhhhhhh','uhu','uhuhuuh','ujuchuuijaaijairpa','ula','ultrafunk','ultrafuuunk','um','uma','umas','umiltà','ummmmhhh','und','under','underground','understand','underworld','une','unemployment','unen','uns','uo','uoh','uohh','uohhh','uohhhhh','uojo','uoo','uoohhh','uooo','uoooh','uooohh','uooohhh','uoooohhh','uooooo','uouoh','uouooooo','uououoooo','up','upon','uppercut','upset','us','use','used','users','uses','ushuaia','ute','uu','uuh','uuu','uuuaaaaaaaaaaaaaaaa','uuuahuuuh','uuuh','uuuhhh','uuuhuuuh','uuuu','uuuuu','uuuuuh','uuuuuhh','uuuuuhhhh','uuuuuuuu','uy','vaa','vaaaaamos','vaaaaan','vaala','vacã','vago','vagon','vagón','vahos','vai','vaiven','vaivn','valcon','vallas','valle','valles','velis','vellas','vendraaaa','venom','verchwindet','vergarabat','vermú','vero','vers','verse','versão','vertebre','very','verão','vibration','vibres','vicirierpresentiquirakar','vidi','viditai','vie','vigía','vigías','viking','vingar','vingoe','vivem','vnganse','vo','voador','voando','você','vocês','voice','vois','vontade','voo','voodoo','voptos','voté','vou','vous','vulcão','vão','vê','vêm','vón','waaah','wachas','wacho','wait','waited','waitin','waiting','waits','wake','walk','walker','walki','walkies','wall','walt','wan','wanna','want','wants','war','was','wash','waste','watch','water','wave','way','wayne','we','weather','weba','weed','wel','welcome','well','welthen','wendy','went','were','wetnisale','wey','whappinï','what','when','where','whether','while','whip','whisky','white','who','whooooa','whoooooa','whooooooa','whopper','why','wicked','wide','wie','wielding','wifi','will','williams','win','wing','wings','winning','wiro','witch','witches','with','wo','woh','wohh','woman','won','woo','woody','woodz','wooh','woooo','works','world','worry','worshipped','would','wow','woy','wrong','wunden','wundervolle','xanax','xipe','xisnove','xoconostle','xq','ya','yaaaaaaaaaaaaa','yabram','yacare','yacaré','yace','yacen','yagas','yahweh','yales','yamas','yang','yanyo','yarabarijei','yarará','yase','yate','yaya','yayayayayaya','yayayyyyy','ye','yea','yeaaaaaahhhh','yeaaaah','yeaaah','yeaaahh','yeah','yeahh','years','yeca','yeeaah','yeeah','yeeahh','yeeeah','yeeeh','yeeh','yegua','yeh','yellow','yes','ygrita','ygrito','yi','yija','yin','ying','yirando','yiritos','ymca','yo','yoga','yojamas','yome','yoo','york','yoruguas','you','young','your','yourself','ypur','yugando','yugi','yuuuu','yuyo','yuyos','yyo','yyyyyyyyyyyyy','zas','zattino','zelig','zelo','zen','zero','zetas','zi','zig','zigzaguear','zip','zippo','zoilo','zon','zona','zonza','zoo','zu','zé','½a','½inga','½n','½ol','½oritas','½s','½sica','бngel','їcomo','_____','aa','aaa','aaaaaaaaaaa','aaaaaaaaaaaaagh','aaaaaaaaaaah','aaaaaaaaaah','aaaaaaaaah','aaaaaagh','aaaaaah','aaaaah','aaaaay','aaaah','aaaahh','aaaahhh','aaaar','aaaasesinos','aaah','aaahooooaaaahh','aah','aahhh','aay','aayy','abas','abend','abofeteoó','abomination','about','abr','abro','acompaсarб','acteal','actemín','acà','acá','au','aunke','aunqe','aunque','auqnue','ay','aya','ayacucho','ayas','ayate','ayaya','ayayayayay','ayer','ayi','ayo','ayrton','ayy','ayyyaay','ayyyy','ayyyyy','ayyyyyy','azu','aço','ação','aéreo','añeja','babor','baby','babylon','babyshay','back','backgamon','backstage','backup','badman','bafle','bagallo','bagartos','bagayito','baglhieto','bagulho','bagullito','bagüal','bah','bahía','bai','baixam','baixou','bao','bar','bardot','barela','bares','battles','baul','baun','baunilha','bb','be','beamer','bearded','beast','beat','beatles','beato','beats','beben','bebí','beca','because','beck','become','bed','bedet','bedronclos','bee','beef','been','bees','beezy','before','behind','beia','beibi','beicon','beige','being','bela','beldad','beleuchtet','believe','belly','belongs','bem','ben','benefit','benelux','benere','berisotu','best','bestia','bestial','bestias','besándome','besé','besó','beta','beto','better','bety','beverly','bevo','bewahre','bi','biaba','bianchi','bibibibip','bibita','biblia','bic','bieber','bien','biendebe','biene','big','bigote','bijouterie','bikini','bill','billion','billy','bin','bingo','bip','bird','biribiribiridi','biridubau','birnieff','birone','birra','bisantino','bisnis','bitch','bites','bla','black','blackout','blackperry','blade','blame','blast','bleed','bleeding','bleo','blocks','blood','bloody','bloqueio','blu','blue','blues','blvckhoney','blá','bmw','bo','boa','board','boarding','bob','boba','bobas','bobbit','bodrio','body','bofe','bogart','boicotear','bolhas','boli','bom','bomb','bondi','bone','bones','bonete','bonex','boney','bonnie','boo','boogie','boost','boots','born','borres','bosta','botty','botuteu','boulevar','boulevard','bouncing','boutiques','box','boy','boyasexy','boys','brabo','brace','brah','brain','brains','brainstorm','brasoz','bratha','brava','bravas','bravura','braços','brea','break','breath','brete','bretel','breto','brick','brigadier','brightning','brigitte','brilha','bring','brink','brisa','broche','brochecito','brochette','broke','bromiés','bronca','bronceador','brontodoble','bross','brotha','brother','brought','brows','bruce','bruces','brucio','bruxo','brycream','bu','bubu','buchanans','buche','buches','buchés','buchón','buda','budge','budín','bue','bueh','buelva','buen','buerlando','buf','bugs','buhos','built','buitre','bukana','bule','buleeeeeee','buleeeeeeeeee','bulevar','bulgaria','bulla','bulín','bumerang','bunny','buns','buonjorge','buque','buri','buried','burn','burning','buroku','burra','busquй','busquйs','but','buuummm','buy','by','bya','bye','ca','caaaayeeees','caaariñiiito','cachaça','cachet','cacheteé','cair','caixa','calm','calçadas','caló','cambiary','caminha','caminhando','caminhar','caminho','caminhos','can','cantegril','caralho','carbn','carbun','card','care','cari','caribean','carl','carrillitos','carrillo','cay','cayar','caye','cbgb','cd','ce','cece','cecehaches','ces','cese','cevitur','ceñas','cha','chaaaaaaa','chabn','chachachá','challenger','changuich','changuicha','chant','chao','chapadmalal','charamascas','charanga','charango','charrascados','charrasqueada','charrock','charrockanrol','charros','charter','chañar','che','cheap','check','cheeeeesssseeee','cheese','chef','chega','chegaquiss','chegar','chegou','chegue','cheikspier','chela','chemo','chenas','chequera','chequeras','cheques','cherie','chichachicha','chizitos','chocó','chombo','chomp','chris','christ','chrjster','chronic','chu','chuan','chão','chín','chón','ci','cia','ciao','cias','cidade','cieco','cielito','cien','cifrão','cigarettes','cil','cime','cipayos','city','ckers','claim','clam','claman','clamor','clan','clark','claro','claros','clash','claude','claus','click','clicka','clika','clikon','climbed','clip','clo','cloaca','close','closed','closet','clouds','clown','club','clubs','clyde','cnela','co','coach','cocktail','cocofunka','cocoliche','coi','coice','coiffer','coisa','coisas','cold','conexão','conoció','conviccin','cool','coolo','cor','cora','coraje','corajuda','coral','coraz','coraza','corazn','corazó','corazуn','coração','corbata','corbett','corchasos','corn','corner','coroné','corpo','corri','corrés','cos','così','could','coule','counter','country','coupé','coure','cowboy','coya','crack','crammed','crash','crater','crazy','crea','creaciûn','cream','creeeeo','crew','criti','critics','critique','crochet','cromossomos','crono','crossfit','croto','crotos','crowd','crown','cry','crying','cter','cua','cuan','cuano','tens','tenï','ter','terminaaar','tesei','test','tetris','tetto','teu','teve','tha','thacher','than','that','the','their','thelma','them','then','there','thermo','these','they','thief','thigh','thing','things','think','thinking','third','thirty','this','thoot','thor','those','though','thought','thoughts','thousand','thrash','three','throne','through','ti','tico','ticos','tieeeempo','tight','tii','tiii','tiiiii','tiiiiiiii','tiki','tim','tin','tina','tinage','tinchos','tinelli','tinha','tinku','tire','tired','tiren','tires','tiro','tiré','tiró','tita','titi','tities','tity','tití','tive','tiver','tmb','tnemos','to','toa','today','todos','toget','together','toi','toilette','toke','toko','tom','tonca','tonce','tonight','too','took','tooodo','topsito','topï','tori','totec','touch','touchdown','tour','tout','town','toxic','toy','tra','cui','cuidadoconlacanaoqueva','cuil','cuit','cuitron','culata','cuore','cuota','cuotas','cupido','cuqui','cuquita','cure','curen','cures','curte','cus','cusan','cuspa','cuuuuuure','cuz','cuzão','cuáima','cyber','czech','cá','cã','cão','cê','cês','cбscara','da','dacuspa','daddy','daddye','dadiboso','daleeee','dalila','dalla','dallas','dalle','damajuana','dan','dancen','dancin','dancing','dans','dany','dançarem','daqui','daquilo','dare','darei','darell','dark','darlin','darling','darmi','das','dass','dat','date','datos','dava','david','day','de','dead','dealer','dealing','deambula','deambulando','deambulaste','death','deba','decapite','decay','deceit','decime','decisão','decola','decolo','decora','decorrente','decrece','decrescer','decï','deep','defeats','dehind','dei','deixa','deixar','dejï','dejйs','delas','delata','delatan','delay','dele','deleita','deleitaban','deleitan','della','delle','delta','demais','dembow','demon','den','depuis','deque','der','des','df','dgi','dgo','di','dia','diazepunk','dicte','dicto','dictó','dicção','did','didn','die','dif','difcil','dig','digs','dil','din','disk','disney','disneyworld','diversiï','diviso','divo','diz','dizer','diàfani','diò','dió','dj','djs','do','doc','dodne','doente','does','doesn','dog','doggys','dogs','doing','dois','dolar','dolce','doll','dom','doma','domain','domar','dondellas','done','donjuan','donovan','donquiera','dont','door','dopada','doping','doris','dort','dos','dose','dosis','dou','doux','dove','down','dr','dragónv','dre','dream','dreams','drena','drenaba','driblando','drink','drive','driving','drogocop','droguen','drowns','drugs','dsecajetado','du','duas','dubidubiduuuuu','duce','ducuruduru','duhalde','dumbass','dumont','dunhill','dust','duu','dylan','dá','dé','dés','dê','dí','dói','ea','each','eaeaapepe','eagle','eah','earth','easy','eat','snook','snoop','so','soap','soar','soldi','soldier','sole','solidão','som','somar','some','somebody','someday','someten','someterme','something','sometiendo','sometimes','someto','sondreir','song','songs','sonhado','sonho','sonhos','sonhou','sorrisinho','sorry','sotto','sou','soufá','soul','soun','south','souvenir','sozinha','sozinho','spacedog','spain','sparite','sparrow','speak','speaking','specchi','speed','spend','spento','sperrow','spider','spiders','spirit','spirits','split','sponsored','sport','spots','spreading','squadra','sr','sssalgo','sta','stadte','stai','stain','stand','star','starbucks','start','starting','starts','stata','state','states','static','stealing','stereo','steven','stile','still','stimme','stiro','sto','stone','stones','stop','storm','strade','stranded','strato','street','stress','strong','stuff','stupid','style','sua','suas','sucedï','suck','sudá','sue','suean','summers','sun','suna','suoni','surpreender','surprise','surreal','surrrrrrr','sushilitto','suvenires','suñir','svástica','swear','sweaty','sweet','swing','switch','sword','system','sã','são','sé','sï','só','ta','taba','tafil','tai','talk','talki','talkies','talking','tao','tapó','taquei','tb','te','teacake','teadero','teams','tear','tears','teee','teeth','teimoso','tekila','tem','temperley','temps','tempête','tendrs','','siggy','siii','siiii','sildavia','silence','sillonnant','silêncio','sim','sincro','sind','sinfo','sing','singela','single','sinogax','sins','sinta','sit','site','situ','skies','skin','skull','sky','skándalo','slam','slash','slave','sleep','sleepe','sleeping','slenderman','slide','slip','slo','slogan','slow','smash','smelin','smettere','smile','smiled','smiles','smock','smog','sneer','snitchi','re','rea','relax','releer','remy','remá','resultó','resume','reto','retobao','reverb','reverdece','revs','revï','rex','rez','rhythm','ri','richar','richards','richthofen','richtofen','ricotta','ride','rider','riders','rige','right','rigido','rigth','riki','rimas','rime','rin','ring','rings','ringside','ringue','rise','ritxchari','riuscito','rivais','rival','rivales','river','riviére','rivotil','rizla','ro','roast','rob','rokayero','roke','rolar','role','roles','roll','rolles','rolling','rollmops','roqa','rotaract','rotundo','roubando','rouge','round','rover','rowdy','royce','rpida','rriba','rron','ru','rua','ruas','rutinas','ruégale','rythm','sa','saara','sabado','sabalero','sabercomo','saberdonde','sabráa','acien','sack','sad','sadaic','sadness','sado','saem','saens','saeta','sai','saia','said','sail','saimos','sair','same','sampler','san','sana','sanan','sanando','sanar','sancocho','sand','sanders','sane','sanes','sang','sange','satiretalised','satisty','sauce','sauces','saumet','savalla','say','says','sazone','saída','sbana','scapes','scared','scasso','schave','schindler','scholl','schon','schumacher','science','scott','scout','scream','screamed','se','sea','seagal','seamos','sean','search','seas','seatbelt','seated','sebo','secen','seco','second','secu','sed','see','seeee','seen','sehe','sei','sein','seis','seja','sem','seme','sen','senna','sensaciï','sente','sentence','senti','sentimentaaaaaal','sers','sert','serte','serú','serб','set','sete','seu','seulement','seus','seven','severed','sex','sexy','seï','sfondare','sha','shadows','shake','shalala','shame','she','sheep','sheetsetrock','sheriff','sherlock','shhh','shikamarau','shinobi','shirley','shit','sho','shock','shoot','shoping','short','should','show','shuriken','sicher','side','sidecar','sigan','siganle','sigas','piel_________','pitito','porco','pordiosera','pordiosero','porfavor','porfiada','porfiar','porfin','porke','positive','positivity','poso','possa','possibili','possiedo','posso','posto','poto','pouco','pounder','pouvaient','povinho','power','powered','poço','ppero','pra','prego','premeditaste','presença','pretty','preço','priced','primus','pris','prives','privi','privé','prize','pro','procurei','procuré','prodan','profits','proiettile','projetos','proud','provado','pry','psikiatrik','ptalos','pub','pubalgia','pue','pupuru','purple','puré','pus','puse','push','puso','pussy','put','pàra','pássaro','pássaros','pé','pés','píñeyro','pò','qe','qiero','qrer','qu','quadrado','qual','qualcosa','quality','quando','quantas','quanti','quanto','quantos','quaranta','quarter','quarto','quee','queeee','queeeeeda','queeeeeeeee','queen','queima','quein','quel','quem','quemúme','quen','quenazo','quente','quer','quero','querйs','questi','questo','quetejedi','quetzalcoatl','qui','quia','quicio','quickly','quin','quis','quizoechar','quía','quï','ra','raa','race','racist','ragga','raggaemuffin','raggamuffin','raggiungere','raiando','rammed','rare','raring','razn','razzia','razão','razónnn','razуn','rculo','ouh','oui','ouoh','our','ourselves','out','outro','outros','outskirts','outta','ouve','ouvir','ova','over','overoles','own','os','osa','otario','other','otono','otraves','otravez','ou','ouah','ouedes','oy','oyee','oyeee','oyia','oyó','oí','pa','pace','perou','ooaaaaa','ooh','oohh','oohhh','oohhhhhh','oompa','ooo','oooaaahhh','oooh','ooohh','ooohhh','oooo','ooooaaa','ooooh','oooohh','oooohhhh','ooooo','oooooh','oooooo','ooooooh','oooooohh','oooooooo','oooooooooh','ooooooooooooooooooo','ooooouu','one','oneil','ones','only','ontá','onvidare','once','ofustalmut','oh','ohh','ohhh','ohhhh','ohhhhh','ohhhhhh','ohhhhhhh','oho','ohoho','ohohohof','ofecerem','ofereça','ofertón','off','offer','offnete','offside','oduro','oeooo','oeoooo','non','nona','nono','noo','nooo','noooo','nooooo','noooooo','nooooooo','noooooooo','norris','norteeeeeeee','nose','noseque','oaaaaa','oaaoaoaoa','oado','oaoaoaoa','oaoaoaoo','não','nè','novinha','novinho','nochessss','noel','noes','nois','noite','nolo','noma','nomade','nomas','novo','now','noção','note','not','mбs','mï','mó','mãe','mão','na','naa','naaa','mordés','mordí','more','naanatinguitchú','mp','mr','ms','msica','muavelo','much','naceeeeer','moo','moon','milt','milênio','mim','mimabas','mimada','miman','mimetiza','mimetizó','mimos','mimosito','mimsos','metás','meté','metés','metí','metía','meu','meus','meyer','mezcle','mezze','mias','mic','mich','michamba','mientrs','mier','miero','miexistencia','might','migo','miguel','miii','miiiiiii','mil','milha','milhas','milk','ebulição','eccetera','eche','echen','echenlón','eches','echo','eché','echó','ecoo','ee','eea','eeee','eeá','eh','ehehehehhe','ehh','ehhhh','ehp','eiaa','el','ela','elante','elas','ele','eleccin','electric','eles','eleven','elevo','elevé','eliot','eloim','else','em','embaixo','entrfa','então','envició','enxergo','enzo','er','ere','erigirás','erinnerungen','es','esa','esarticha','esas']

json_files = [pos_json for pos_json in os.listdir(path_to_json) if pos_json.endswith('.json')]
jsons_data = pd.DataFrame(columns=['title', 'album', 'year','lyrics','artist'])
for index, js in enumerate(json_files):
    with open(os.path.join(path_to_json, js)) as json_file:
        json_text = json.load(json_file)
        title = json_text['songs'][0]['title']
        album = json_text['songs'][0]['album']
        year = json_text['songs'][0]['year']
        lyrics = json_text['songs'][0]['lyrics']
        artist = json_text['artist']
        jsons_data.loc[index] = [title, album, year, lyrics, artist]

clean_song= []

for i in range(0,len(jsons_data)):
    p0 = re.sub( '\n'                                                                               , ' ', jsons_data.at[i,'lyrics'].lower()) 
    p1 = re.sub( '\[[\*¿?!¡\[\]\+\-\"\'\(\)\/\+¿?!¡\.\"\:,;\/\\\'\&$“”’öüñèáéíóúa-z0-9 ]+\]'        , ' ',p0   )
    p2 = re.sub( '\([°\*—\[\]\+\-\"\'\(\)\/\+¿?!¡\.\"\:,;\/\\\'\&$“”’öüñèáéíóú…´a-z0-9 ]+\)'       , ' ',p1   )
    p3 = re.sub( '[\(\)\[\]\+¿?!¡\.\":,;\/\\\'-=»«]+'                                               , ' ',p2   )
    p4 = re.sub( ','                                                                                , ' ',p3   )
    #p5 = re.sub( '[ ]+'                                                                             , ' ',p4.strip())
    p5=[]
    for i in p4.split():
        if i not in words:
            p5.append(i)
    p5= " ".join(p5)

    clean_song.append(p5)
#Agregamos cancion limpia
jsons_data["cleanSongs"]=clean_song
#Eliminamos todas las canciones con letras muy pequeñas o inexistentes
jsons_data = jsons_data.loc[ jsons_data['cleanSongs'].str.split().str.len() > 30] 
#Dejamos solo el año de release
jsons_data['year'] = jsons_data['year'].str.slice(0,4)
jsons_data = jsons_data[['artist','album','year','title','cleanSongs']]
#Reinicio de indice
jsons_data = jsons_data.reset_index()
del jsons_data['index']
#Getting compression level
songs = jsons_data[['cleanSongs']]
compression_rate=[]
#
for i in range (0,len(songs)):
    f=open(master_path+'compress/'+str(i)+'.txt',"w+")
    f.write(songs.at[i,'cleanSongs'])
    f.close()
    os.system("gzip "+master_path+'compress/'+str(i)+'.txt')
    compression_rate.append( subprocess.check_output("gzip -l "  +master_path+"compress/"+str(i)+".txt.gz"+  " | tail -1 | awk {'print $3'}", shell=True)[:-2].decode("utf-8") )
    os.system("rm "+ master_path+"compress/"+str(i)+".txt.gz")
jsons_data["compression_rate"]=compression_rate
export_csv = jsons_data.to_csv(master_path+'clean_songs.cvs')
